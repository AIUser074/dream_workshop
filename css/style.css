@font-face {
    font-family: 'GeumEunBoHwa';
    src: url('../assets/font/나눔손글씨 금은보화.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}
@font-face {
    font-family: 'Amsterdam';
    src: url('../assets/font/나눔손글씨 암스테르담.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}

body, html {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    /* background-color 제거 */
    display: flex;
    justify-content: center;
    align-items: center;
}

#game-background {
    position: fixed;
    inset: 0;
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
    filter: blur(10px);
    transform: scale(1.1); /* 블러로 인해 가장자리가 하얗게 되는 현상 방지 */
    z-index: -1; /* 뷰포트 뒤에 위치 */
}

#game-viewport {
    position: relative;
    width: 100vw;
    height: calc(100vw * 16 / 9); /* 9:16 비율 유지 */
    max-height: 100vh;
    max-width: calc(100vh * 9 / 16);
    overflow: hidden;
    margin: auto;
}

#game-container {
    width: 100%;
    height: 100%;
    display: flex;
    justify-content: center;
    align-items: center;
    position: relative;
    background-image: url('../assets/images/ui/Title_bg.png');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
}

.title-screen {
    text-align: center;
    color: #4a4a4a; /* 기존 white에서 짙은 회색으로 변경하여 가독성 확보 */
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: opacity 0.5s ease-out; /* 페이드아웃 효과를 위한 transition 추가 */
}

.title-screen.fade-out {
    opacity: 0;
    pointer-events: none;
}

.title-container {
    position: relative;
    display: block;
    margin-top: -6%; /* 타이틀 크기 축소에 맞춰 위치 조정 */
    transform: translateY(0); /* 초기 위치를 0으로 명시하여 점프 방지 */
    animation: title-float 6s ease-in-out 1.6s infinite alternate; /* 타이틀과 구름을 함께 부드럽게 이동 */
    will-change: transform;
}

.title-cloud {
    position: absolute;
    top: 40%; /* 중앙으로 살짝 내려서 안정감 부여 */
    left: 50%;
    transform: translate(-50%, -50%);
    width: 160%; /* 타이틀 크기 축소에 맞춰 구름 크기 조정 */
    max-width: none; /* 고정 뷰포트에서는 불필요 */
    z-index: 1;
    opacity: 0.9;
    filter: drop-shadow(0 6px 12px rgba(0, 0, 0, 0.12));
    pointer-events: none; /* 구름이 버튼 상호작용을 가로막지 않도록 */
    animation: cloud-float 10s ease-in-out 1.6s infinite alternate; /* 더 동적인 플로팅 */
}

.game-title {
    position: relative;
    z-index: 2; /* 구름 위에 표시 */
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive; /* 금은보화 폰트 우선 적용 */
    /* font-size는 JS에서 동적으로 설정하므로 rem 단위 제거 */
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.25); /* 가독성을 위해 그림자 강화 */
    animation: slide-up 1.5s ease-out forwards;
    opacity: 0;
    transform: translateY(50px);
    font-weight: bold; /* 브라우저 자체 볼드 처리 */
    letter-spacing: 0; /* 자간을 줄여 텍스트 너비 축소 */
    -webkit-text-stroke: 0; /* 색상이 다양해지므로 외곽선은 제거 */
    white-space: nowrap; /* 타이틀 줄바꿈 방지 */
}

.game-title span:nth-child(1) {
    color: #ffb3ba; /* 파스텔 핑크 */
}
.game-title span:nth-child(2) {
    color: #ffdfba; /* 파스텔 오렌지 */
}
.game-title span:nth-child(3) {
    color: #baffc9; /* 파스텔 민트 */
}

.start-button {
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive; /* 폰트 통일 */
    padding: 1.8% 4%; /* 패딩을 줄여 크기 축소 */
    border: none;
    border-bottom: 5px solid #c06c6c; /* 입체감을 위한 하단 테두리 */
    border-radius: 50px;
    background-color: #ffffff;
    color: #e57373;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    cursor: pointer;
    transition: all 0.15s ease-out; /* 전환 속도 조절 */
    margin-top: 17%; /* 기존 5%에서 7%로 살짝 낮춤 */
    animation: fade-in 1s 1s ease-in forwards;
    opacity: 0;
    font-weight: bold;
    letter-spacing: 0.5px;
    position: relative;
    z-index: 3;
}

.start-button:hover {
    transform: translateY(-2px); /* 호버 시 미세하게 이동 */
    box-shadow: 0 6px 8px rgba(0, 0, 0, 0.15);
}


@keyframes slide-up {
    from {
        opacity: 0;
        transform: translateY(50px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

@keyframes fade-in {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@keyframes cloud-float {
    0%   { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
    25%  { transform: translate(calc(-50% + 0.8%), -49.6%) scale(1.008) rotate(0.12deg); }
    50%  { transform: translate(calc(-50% + 1.2%), -49.0%) scale(1.012) rotate(0.2deg); }
    75%  { transform: translate(calc(-50% - 0.6%), -49.4%) scale(1.006) rotate(0.1deg); }
    100% { transform: translate(-50%, -48.8%) scale(1) rotate(0deg); }
}

@keyframes title-float {
    from { transform: translateY(0); }
    to { transform: translateY(1.2%); }
}

.hidden {
    display: none !important;
}

/* ===== Pastel Theme Variables & Utilities ===== */
:root {
    --pastel-pink: #ffb3ba;
    --pastel-orange: #ffdfba;
    --pastel-mint: #baffc9;
    --pastel-blue: #a0e7e5;
    --ink: #4a4a4a;
    --glass-bg: rgba(255, 255, 255, 0.55);
    --glass-stroke: rgba(255, 255, 255, 0.9);
    --shadow: 0 6px 12px rgba(0, 0, 0, 0.12);
    /* solid panel tones for opaque badges */
    --panel-bg: #d8a187; /* warm wood-like */
    --panel-stroke: #8f5a49; /* darker edge */
}

.glass {
    background: var(--glass-bg);
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    box-shadow: var(--shadow);
}

.badge {
    padding: 0.2rem 0.5rem;
    border-radius: 999px;
    border: 1px solid rgba(255,255,255,0.6);
}

.fade-slide-in {
    opacity: 0;
    transform: translateY(10px);
    animation: fadeSlideIn 600ms ease-out forwards;
}

@keyframes fadeSlideIn {
    to { opacity: 1; transform: translateY(0); }
}

/* Main Workshop UI */
#main-container {
    position: absolute;
    inset: 0;
    display: flex;
    flex-direction: column;
    background-image: url('../assets/images/ui/main_bg.png');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
    /* opacity와 animation 제거 */
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive; /* 메인 UI 전용 폰트 */
}

/* mainEnter 키프레임 제거 또는 주석 처리 */
/*
@keyframes mainEnter {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
}
*/

/* 상태 바 - 분리된 배지 스타일 */
.status-bar {
    position: absolute;
    top: env(safe-area-inset-top, 0px);
    left: 0;
    right: 0;
    z-index: 20;
    display: flex;
    justify-content: space-between; /* 양 끝 정렬로 변경 */
    align-items: flex-start; /* 상단 기준 정렬 */
    gap: clamp(6px, 1.5vw, 16px);
    padding: clamp(4px, 1vw, 8px) clamp(8px, 3vw, 16px);
    animation: fadeSlideIn 700ms ease-out 200ms forwards;
    box-sizing: border-box;
}

.status-group-center {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: clamp(6px, 1.5vw, 16px);
    flex-wrap: wrap;
}

/* 왼쪽 상단 메인 레벨 배지 스타일 */
.level-badge-main {
    position: relative; /* 다리 기준점 */
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 4px; /* 레벨 텍스트와 경험치 바 사이 간격 */
    background: #8a9aab !important; /* 색상 강제 적용 */
    border: 2px solid #5d6b7a !important; /* 테두리 강제 적용 */
    padding: clamp(6px, 1vw, 8px) clamp(16px, 2.5vw, 22px);
    transform: translateY(0) !important; /* 처음부터 내려와 있도록 위치 고정 */
    box-shadow: 0 8px 12px rgba(0,0,0,0.22);
    transition: none !important; /* 호버 효과 제거 */
}

.sign-legs {
    position: absolute;
    bottom: 95%;
    left: 15%;
    right: 15%;
    height: 10px;
    background: transparent;
    border-left: 4px solid #5d6b7a;
    border-right: 4px solid #5d6b7a;
}

.level-badge-main .badge-text {
    color: #fff;
    text-shadow: 1px 1px 1px rgba(0,0,0,0.3);
    padding: 0; /* 불필요한 패딩 제거로 중앙 정렬 보정 */
    padding-left: clamp(4px, 1vw, 8px); /* 왼쪽 여백 살짝 부여 */
}

.xp-bar-container {
    width: calc(100% - clamp(4px, 1vw, 8px));
    height: 10px;
    background-color: rgba(0, 0, 0, 0.2);
    border-radius: 5px;
    overflow: hidden;
    margin-left: clamp(4px, 1vw, 8px);
}

.xp-bar-fill {
    width: 20%;
    height: 100%;
    background-color: #a8d5e2;
}


.settings-button {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
}

.settings-button img {
    width: clamp(28px, 2.5rem, 40px);
    height: auto;
    transition: transform 0.2s ease;
}

.settings-button:hover img {
    transform: rotate(45deg);
}


.status-badge {
    display: flex;
    align-items: center;
    gap: clamp(4px, 1vw, 8px);
    padding: clamp(4px, 0.8vw, 6px) clamp(10px, 2vw, 14px);
    padding-left: clamp(4px, 1vw, 8px); /* 좌측 패딩 추가 */
    background: var(--panel-bg); /* 불투명 패널 */
    border: 2px solid var(--panel-stroke);
    border-radius: 6px; /* 각진 느낌 */
    box-shadow:
        0 6px 10px rgba(0,0,0,0.18), /* drop */
        inset 0 1px 0 rgba(255,255,255,0.35), /* top highlight */
        inset 0 -2px 3px rgba(0,0,0,0.08); /* inner shade */
    transition: transform 120ms ease, box-shadow 120ms ease;
}

.status-badge:hover {
    transform: translateY(-1px);
    box-shadow:
        0 8px 12px rgba(0,0,0,0.2),
        inset 0 1px 0 rgba(255,255,255,0.4),
        inset 0 -2px 3px rgba(0,0,0,0.1);
}

.badge-icon {
    width: clamp(18px, 1.8rem, 32px);
    height: clamp(18px, 1.8rem, 32px);
    object-fit: contain;
    filter: none; /* 불투명 스타일에 맞춰 하이라이트 제거 */
}

.badge-text {
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700; /* 선명한 볼드 */
    font-size: clamp(18px, 1.8rem, 22px);
    color: #2c2320; /* 패널 위에서 잘 보이는 잉크 색 */
    white-space: nowrap;
}

/* 개별 배지 색상 강조 - day-badge와 level-badge 제거 */
.fame-badge { border-color: var(--panel-stroke); }
.gold-badge { border-color: var(--panel-stroke); }

.atelier-table {
    position: absolute;
    bottom: -17%; /* 살짝 더 아래로 내림 */
    left: 0;
    width: 100%;
    pointer-events: none; /* 테이블이 다른 UI 요소 클릭을 막지 않도록 */
    z-index: 12; /* NPC보다 위에 오도록 설정 */
}

.status-right {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
}

.attendance-icon-button {
    background: none;
    border: none;
    cursor: pointer;
    padding: 0;
}

.attendance-icon-button img {
    width: clamp(36px, 4rem, 50px);
    height: auto;
    transition: transform 0.2s ease;
}

.attendance-icon-button:hover img {
    transform: translateY(1px);
}

/* 개별 하단 액션 버튼 */
.action-btn-individual {
    position: absolute;
    z-index: 15;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 4px;
    width: clamp(70px, 16vw, 88px); /* 크기 소폭 증가 */
    height: clamp(70px, 16vw, 88px); /* 크기 소폭 증가 */
    background: #fdf6e3; /* 아이보리 */
    border: 3px solid #654321; /* 짙은 갈색 */
    border-radius: 12px;
    box-shadow: 0 6px 0 0 #654321; /* 입체감을 위한 두꺼운 그림자 */
    cursor: pointer;
    transition: all 0.1s ease-out;
}

.action-btn-individual:active {
    transform: translateY(4px);
    box-shadow: 0 2px 0 0 #654321;
}

#btn-upgrade { bottom: 3%; left: 5%; }
#btn-shop { bottom: 3%; left: 28%; }
#btn-quest { bottom: 3%; right: 28%; }
#btn-log { bottom: 3%; right: 5%; }

.action-icon {
    width: clamp(32px, 5.5vw, 44px); /* 아이콘 크기 소폭 증가 */
    height: clamp(32px, 5.5vw, 44px); /* 아이콘 크기 소폭 증가 */
    object-fit: contain;
}

.action-label {
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    font-size: clamp(15px, 2.8vw, 17px); /* 폰트 크기 소폭 증가 */
    color: #654321;
}

/* NPC & Dialog Box - 동적 생성 대응 */
.npc-wrapper {
    position: absolute;
    bottom: 10%;
    left: 50%;
    transform: translateX(-50%);
    width: clamp(180px, 35vw, 240px); /* data.js의 baseScale로 덮어쓰여짐 */
    z-index: 5; /* 테이블 뒤에 오도록 */
    display: flex;
    flex-direction: column;
    align-items: center;
    visibility: hidden; /* 초기에는 숨김 */
}

.npc-wrapper img {
    width: 100%;
    transform: translateY(100%);
    opacity: 0;
    transform-origin: bottom center; /* 스쿼시/스트레치 기준 */
}

/* Entrance animation - forwards 제거 */
.npc-wrapper.animate-enter img {
    animation: npc-pop-up 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) 0.5s;
}

/* Idle animation for all NPCs */
.npc-wrapper.npc-idle img {
    /* 애니메이션 시작 전 초기 상태를 등장 후 상태와 동일하게 설정 */
    transform: translateY(0);
    opacity: 1;
    animation: npc-idle 2.8s ease-in-out infinite alternate;
}

@keyframes npc-idle {
    0%   { transform: translateY(0) scaleX(1.00) scaleY(1.00); }
    50%  { transform: translateY(0) scaleX(0.985) scaleY(1.015); }
    100% { transform: translateY(0) scaleX(1.01) scaleY(0.99); }
}

.dialog-box {
    position: absolute;
    background: #fff;
    border: 3px solid #654321;
    border-radius: 12px;
    padding: 12px;
    text-align: center;
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    opacity: 0;
    visibility: hidden;
    transform: none !important; /* JS에서 transform을 직접 제어하므로 초기화 */
}

.dialog-box::after, .dialog-box::before {
    content: '';
    position: absolute;
    left: 50%;
    transform: translateX(-50%);
    border-style: solid;
}
.dialog-box::after { /* a little bigger for border */
    bottom: -13px;
    border-width: 13px 13px 0 13px;
    border-color: #654321 transparent transparent transparent;
}
.dialog-box::before {
    bottom: -10px;
    border-width: 11px 11px 0 11px; /* 테두리를 완전히 덮도록 크기 살짝 키움 */
    border-color: #fff transparent transparent transparent;
    z-index: 1;
}

.dialog-text {
    margin: 0;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    font-size: clamp(16px, 2.8vw, 20px); /* 폰트 크기 증가 */
    color: #654321;
}

.dialog-text span {
    display: none; /* 레이아웃에서 제외하여 커서가 끝 글자 옆에 위치 */
}
.dialog-text span.visible {
    display: inline;
}

/* 타자기 커서 효과 */
.dialog-text.typing::after {
    content: '|';
    animation: blink 1s step-end infinite;
    margin-left: 2px;
    font-weight: 100;
}

@keyframes blink {
    from, to { color: transparent; }
    50% { color: #654321; }
}

/* Animations */
.animate-enter { visibility: visible !important; }
.dialog-box.animate-enter { animation: dialog-fade-in 0.4s ease-out 1.2s forwards; }

@keyframes npc-pop-up {
    from { transform: translateY(100%); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

@keyframes dialog-fade-in {
    from { transform: translateY(20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}

/* '다음' 화살표 스타일 */
.next-arrow {
    position: absolute;
    bottom: 8px;
    right: 12px;
    font-size: clamp(12px, 2vw, 14px);
    color: #654321;
    visibility: hidden; /* 평소에는 숨김 */
    opacity: 0;
    transition: opacity 0.2s ease;
}

.next-arrow.visible {
    visibility: visible;
    opacity: 1;
    animation: bounce-arrow 0.8s ease-in-out infinite;
}

@keyframes bounce-arrow {
    0%, 100% {
        transform: translateY(0);
    }
    50% {
        transform: translateY(-4px);
    }
}

/* ===== 화면 전환 스타일 (수정) ===== */
.screen {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    /* opacity와 transform을 함께 transition하도록 설정 */
    transition: transform 0.6s cubic-bezier(0.45, 0, 0.55, 1), opacity 0.5s ease-out;
}

/* 슬라이드 효과를 위한 기본 상태 */
.screen.screen-slide {
    transform: translateX(100%);
    opacity: 1; /* 페이드 효과 방지를 위해 명시적으로 불투명하게 설정 */
}

/* 페이드 효과를 위한 기본 상태 */
.screen.screen-fade {
    transform: translateX(0); /* 슬라이드되지 않도록 위치 고정 */
    opacity: 0;
    pointer-events: none;
}

/* 화면이 활성화되었을 때의 상태 */
.screen.active-screen {
    transform: translateX(0);
    opacity: 1;
    pointer-events: auto;
}

/* 슬라이드로 퇴장할 때의 상태 */
.screen.exit-left {
    transform: translateX(-100%);
    opacity: 1;
}

.screen.exit-right {
    transform: translateX(100%);
    opacity: 1;
}

/* ===== 그림 그리기 모드 UI 스타일 (수정) ===== */
#drawing-mode-container {
    /* position, inset 등은 .screen 에서 상속받으므로 제거 가능 */
    background-image: url('../assets/images/ui/draw_bg.png');
    background-size: cover;
    background-position: center;
    z-index: 50;
    display: flex;
    justify-content: center;
    align-items: center;
    overflow: hidden; /* 내부 요소가 넘치지 않도록 */
}

.drawing-table-top,
.drawing-table-bottom {
    position: absolute;
    left: 0;
    width: 100%;
    z-index: 52;
    pointer-events: none; /* 테이블이 마우스/터치 이벤트를 가로채지 않도록 설정 */
}

.drawing-table-top {
    top: -30%; /* 더 위로 이동 */
    transform: rotate(180deg); /* 위쪽 테이블은 뒤집어서 사용 */
}

.drawing-table-bottom {
    bottom: -30%; /* 더 아래로 이동 */
}

.canvas-wrapper {
    position: relative;
    width: 110%; /* 캔버스 너비 매우 확대 */
    height: 110%; /* 캔버스 높이도 확대 */
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 51;
    top: 5%; /* 캔버스 살짝 내리기 */
}

.drawing-canvas-img {
    width: 110%;    /* 캔버스 이미지 크기 매우 확대 */
    height: auto;
    max-height: 110%; /* 최대 높이도 크게 허용 */
    object-fit: contain;
    filter: drop-shadow(0 10px 20px rgba(0,0,0,0.2));
}

/* 드로잉 캔버스 */
#paint-canvas {
    position: absolute;
    inset: 0; /* wrapper 가이드 안에서 가득 채움 (이미지와 동일 비율) */
    width: 100%;
    height: 100%;
    pointer-events: auto; /* 입력 허용 */
    clip-path: inset(8.3% 5% 17.5% 5% round 10px);
    touch-action: none; /* 모바일 터치 스크롤 등 기본 동작 비활성화 */
}

/* ===== 그림 그리기 도구 UI 스타일 ===== */
.drawing-tools-wrapper {
    position: absolute;
    bottom: -0.5%; /* 하단 테이블 위에 위치하도록 조정 (살짝 내림) */
    left: 0; /* 전체 폭 사용 */
    transform: none; /* 중앙 변환 해제 */
    width: 100%; /* 화면 가로 전체 사용 */
    z-index: 53; /* 테이블 위에 오도록 */
    display: flex;
    align-items: center;
    justify-content: flex-start; /* 좌측부터 배치 시작 */
    gap: 2vw; /* 간격을 vw로 고정 */
    background-color: rgba(0, 0, 0, 0.1);
    padding: 1vw 5%; /* vw 기반 패딩 */
    box-sizing: border-box; /* 패딩 포함 너비 계산 */
    border-radius: 0; /* 전체 폭 바에서 라운드 제거 */
}

.color-palette {
    display: flex;
    gap: 10px;
}

.color-btn {
    width: 4.2vw; /* 고정 비율 */
    height: 4.2vw; /* 고정 비율 */
    border-radius: 50%;
    border: 2px solid transparent; /* 테두리 두께 유지 */
    cursor: pointer;
    transition: all 0.2s ease;
}

.color-btn:hover {
    transform: scale(1.1);
}

.color-btn.active {
    border-color: #654321; /* 다른 버튼과 동일한 갈색 테두리 */
    box-shadow: none; /* 빛나는 효과 제거 */
    transform: scale(1.1); /* 선택되었음을 나타내는 확대 효과 */
}

.tool-buttons {
    display: flex;
    align-items: center;
    gap: 1.6vw; /* 고정 비율 */
    flex: 1; /* 우측 끝까지 공간 차지 */
}

/* '모두 지우기' 버튼부터 우측으로 밀기 */
#btn-reset-canvas {
    margin-left: auto;
}

.tool-btn {
    background: #fdf6e3;
    border: 2px solid #654321; /* 테두리 두께 축소 */
    border-radius: 14px; /* 모서리 둥글기 축소 */
    width: 5.6vw; /* 고정 비율 */
    height: 5.6vw; /* 고정 비율 */
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: all 0.2s ease;
}

.tool-btn:hover {
    background-color: #fff;
}

.tool-btn img {
    width: 140%; /* 아이콘 크기 증가 */
    height: 140%; /* 아이콘 크기 증가 */
    object-fit: contain;
}

/* ===== 패널/오버레이/모달 ===== */
.draw-overlay {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.2);
    z-index: 100;
}
.draw-overlay.hidden { display: none; }

.draw-panel {
    position: fixed;
    top: 18%;
    left: 50%;
    transform: translateX(-50%);
    min-width: 260px;
    max-width: 70vw;
    background: #fff;
    border: 2px solid #654321;
    border-radius: 12px;
    padding: 12px 14px;
    z-index: 101;
    box-shadow: 0 10px 24px rgba(0,0,0,0.18);
}
.draw-panel.hidden { display: none; }

.panel-header {
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    color: #654321;
    margin-bottom: 10px;
}

.panel-grid {
    display: grid;
    grid-template-columns: repeat(6, minmax(28px, 1fr));
    gap: 8px;
}

/* 붓 크기 전용 그리드 간격 보정 */
.brush-grid {
    grid-template-columns: repeat(6, 1fr);
}

.color-swatch {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    border: 2px solid #654321;
    cursor: pointer;
}

.size-chip {
    padding: 6px 10px;
    background: #fdf6e3;
    border: 2px solid #654321;
    border-radius: 10px;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    cursor: pointer;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: background-color 0.2s; /* 부드러운 전환 효과 */
}

.size-chip:hover {
    background: #e0d8c7;
}

.size-chip.active {
    background: #a8d5e2; /* 활성화 시 배경색 변경 */
    border-color: #5d6b7a;
}

/* 실제 붓 크기를 표현하는 점 */
.size-dot {
    display: inline-block;
    border-radius: 50%;
    border: 1px solid rgba(0,0,0,0.15);
}

.slider-row {
    display: flex;
    align-items: center;
    gap: 10px;
}
.slider-row .size-label {
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    color: #654321;
}

.draw-modal {
    position: fixed;
    inset: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 102;
}
.draw-modal.hidden { display: none; }

.modal-card {
    background: #fff;
    border: 2px solid #654321;
    border-radius: 12px;
    padding: 16px 20px;
    min-width: 260px;
    box-shadow: 0 10px 24px rgba(0,0,0,0.18);
}
.modal-message {
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    color: #654321;
    margin-bottom: 12px;
}
.modal-actions {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
}
.modal-btn {
    background: #fdf6e3;
    border: 2px solid #654321;
    border-radius: 10px;
    padding: 6px 12px;
    cursor: pointer;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive; /* 폰트 적용 */
    font-weight: 700; /* 폰트 두께 적용 */
    color: #654321; /* 텍스트 색상 적용 */
}
.modal-btn.confirm { background: #a8d5e2; }

/* 지우개 버튼 활성화 스타일 */
.tool-btn#btn-eraser.active {
    background-color: #a8d5e2; /* 활성화 시 배경색 변경 */
    box-shadow: inset 0 0 8px rgba(0,0,0,0.2); /* 안쪽 그림자 효과 */
}

/* ===== 그림 그리기 상단 UI 스타일 ===== */
.drawing-header {
    position: absolute;
    top: 0.3%;
    left: 3%;
    right: 3%;
    z-index: 55;
}

.request-panel {
    width: 100%;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 1vw; /* 간격 확대 */
    background: #fdf6e3;
    border: 3px solid #654321;
    border-radius: 2.5vw; /* 두께에 맞춰 반경 확대 */
    padding: 1.2vw 2vw; /* 패딩 확대 (두껍게) */
    box-shadow: 0 4px 6px rgba(0,0,0,0.15);
    box-sizing: border-box;
}

.request-content {
    display: flex;
    align-items: center;
    gap: 1vw; /* 간격 확대 */
}

.timer-container {
    position: relative;
    width: 9vw; /* 크기 확대 */
    height: 9vw; /* 크기 확대 */
}

.timer-svg {
    transform: rotate(-90deg); /* 12시 방향에서 시작 */
}

.timer-bg, .timer-progress {
    fill: none;
    stroke-width: 18; /* 테두리 더 두껍게 */
}

.timer-bg {
    stroke: rgba(101, 67, 33, 0.25); /* 갈색 계열 연하게 */
}

.timer-progress {
    stroke: #a8d5e2;
    stroke-linecap: round;
    stroke-dasharray: 283; /* (2 * PI * 45) */
    stroke-dashoffset: 0; /* JS로 제어 */
    transition: stroke-dashoffset 0.5s linear, stroke 0.5s ease; /* 색상 변경도 부드럽게 */
}

/* 타이머 경고/위험 상태 */
.timer-progress.warning {
    stroke: #ffd166; /* 노란색 */
}
.timer-progress.critical {
    stroke: #ff6b6b; /* 빨간색 */
}

.timer-container.critical {
    animation: shake 0.5s ease-in-out infinite alternate;
}

.timer-text {
    position: absolute;
    inset: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    color: #000000;
    font-size: 4vw; /* 폰트 크기 확대 */
    font-weight: bold;
}

@keyframes shake {
    from { transform: rotate(-3deg); }
    to { transform: rotate(3deg); }
}

.customer-portrait {
    width: 9vw; /* 크기 추가 확대 */
    height: 9vw; /* 크기 추가 확대 */
    border-radius: 1.8vw; /* 두께에 맞춰 반경 확대 */
    border: 2px solid #654321;
}

.request-text {
    margin: 0;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    color: #654321;
    font-size: 4.2vw; /* 크기 추가 확대 */
}

/* ===== 그림 전달 애니메이션 ===== */
#finished-canvas-item {
    position: absolute;
    width: 25vw;
    height: auto;
    z-index: 100;
    /* 초기 위치: 화면 하단 바깥 */
    bottom: -30vw;
    left: 50%;
    transform: translateX(-50%) rotate(-15deg);
    opacity: 0;
    transition: opacity 0.3s ease;
}

#finished-canvas-item.animate-give {
    animation: give-canvas-to-npc 1.5s cubic-bezier(0.36, 0, 0.66, -0.56) forwards;
}

@keyframes give-canvas-to-npc {
    0% {
        bottom: -30vw;
        left: 50%;
        transform: translateX(-50%) rotate(-15deg);
        opacity: 1;
    }
    40% {
        bottom: 14%; /* 포물선 중간 지점 */
        left: 60%;
        transform: translateX(-50%) rotate(20deg) scale(1.1);
        opacity: 1;
    }
    100% {
        /* NPC(토마스)의 가슴팍 위치 근처 */
        bottom: 40%;
        left: 50%;
        transform: translateX(-50%) rotate(5deg) scale(0.5);
        opacity: 0;
    }
}

/* ===== 보상 획득 이펙트 ===== */
#reward-container {
    position: absolute;
    /* NPC 위치 근처 */
    top: 45%;
    left: 43%;
    transform: translateX(-50%);
    z-index: 101;
    pointer-events: none;
}

.reward-item {
    position: absolute;
    display: flex;
    align-items: center;
    background: rgba(253, 246, 227, 0.9);
    border-radius: 5vw;
    padding: 1vw 2vw;
    border: 2px solid #654321;
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
    animation: bounce-up 1.5s cubic-bezier(0.34, 1.56, 0.64, 1) forwards;
}

/* 이모티콘 반응은 더 크고 배경 없이 */
.reward-item.reaction-icon {
    background: none;
    border: none;
    box-shadow: none;
    padding: 0;
    /* 다른 아이템보다 살짝 아래에서 시작해서 더 역동적이게 */
    transform: translateY(5vw); 
}

.reward-item.reaction-icon img {
    width: 15vw;
    height: 15vw;
    margin-right: 0;
}

.reward-item img {
    width: 8vw;
    height: 8vw;
    margin-right: 2vw;
}

/* XP 보상을 위한 텍스트 라벨 스타일 */
.reward-item .reward-label {
    display: inline-flex;
    align-items: center;
    justify-content: center;
    width: 8vw;
    height: 8vw;
    margin-right: 2vw;
    font-size: 4vw;
    font-weight: bold;
    color: #fff;
    background-color: #a770ef; /* 경험치를 나타내는 보라색 계열 */
    border-radius: 50%;
    border: 0.5vw solid #fff;
    box-shadow: 0 0 1vw #a770ef;
}

.reward-item span {
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    font-size: 5vw;
    color: #654321;
}

@keyframes bounce-up {
    0% {
        opacity: 0;
        transform: translateY(0) scale(0.5);
    }
    40% {
        opacity: 1;
        transform: translateY(-15vw) scale(1.1);
    }
    80% {
        opacity: 1;
        transform: translateY(-18vw) scale(1);
    }
    100% {
        opacity: 0;
        transform: translateY(-25vw) scale(0.8);
    }
}

/* ===== 로딩 스피너 UI ===== */
#loading-spinner {
    position: absolute;
    inset: 0;
    z-index: 200;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    background-color: rgba(253, 246, 227, 0.85); /* 반투명 크림색 배경 */
    color: #654321; /* 갈색 텍스트 */
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: bold;
    font-size: 4vw; /* 폰트 크기 확대 */
    text-shadow: 1px 1px 2px rgba(101, 67, 33, 0.2);
}

#loading-spinner.hidden {
    display: none;
}

.spinner {
    width: 12vw; /* 크기 확대 */
    height: 12vw; /* 크기 확대 */
    border: 1.5vw solid #654321; /* 갈색 테두리 */
    border-top-color: #a8d5e2; /* 포인트 색상 */
    border-radius: 50%;
    animation: spin 1s linear infinite;
    margin-bottom: 3vw; /* 간격 확대 */
}

@keyframes spin {
    to {
        transform: rotate(360deg);
    }
}

/* 하단 바: 두껍고 크게 */
.drawing-tools-wrapper {
    position: absolute;
    bottom: -0.5%;
    left: 0;
    transform: none;
    width: 100%;
    z-index: 53;
    display: flex;
    align-items: center;
    justify-content: flex-start;
    gap: 3.5vw; /* 간격 추가 확대 */
    background-color: rgba(0, 0, 0, 0.1);
    padding: 2vw 5%; /* 패딩 추가 확대 (더 두껍게) */
    box-sizing: border-box;
    border-radius: 0;
}

.color-btn {
    width: 9vw; /* 크기 추가 확대 */
    height: 9vw; /* 크기 추가 확대 */
    border-radius: 50%;
    border: 2px solid transparent;
    cursor: pointer;
    transition: all 0.2s ease;
}

.tool-buttons {
    display: flex;
    align-items: center;
    gap: 3vw; /* 간격 추가 확대 */
    flex: 1;
}

#btn-reset-canvas { margin-left: auto; }

.tool-btn {
    background: #fdf6e3;
    border: 2px solid #654321;
    border-radius: 2.5vw; /* 두께에 맞춰 반경 확대 */
    width: 11vw; /* 크기 추가 확대 */
    height: 11vw; /* 크기 추가 확대 */
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: all 0.2s ease;
}

/* 증가 시각화: 떠오르는 +값 */
.fame-badge, .gold-badge, .level-badge-main {
    position: relative; /* gain-float 절대 위치 기준 */
}

.gain-float {
    position: absolute;
    top: 2px;
    right: 6px;
    padding: 2px 8px;
    border-radius: 999px;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    font-size: clamp(12px, 1.2rem, 14px);
    color: #fff;
    border: 2px solid rgba(255,255,255,0.9);
    box-shadow: 0 4px 8px rgba(0,0,0,0.15);
    animation: gainFloat 0.9s ease-out forwards;
    pointer-events: none;
}

.gain-xp   { background: #a770ef; }
.gain-rep  { background: #6ec1e4; }
.gain-gold { background: #f5c542; color: #4a3b00; border-color: rgba(255,255,255,0.85); }

@keyframes gainFloat {
    0%   { opacity: 0; transform: translateY(14px) scale(0.95); }
    15%  { opacity: 1; transform: translateY(0)    scale(1.0); }
    100% { opacity: 0; transform: translateY(-22px) scale(1.02); }
}

/* 배지 bump 효과 */
.badge-bump {
    animation: badgeBump 0.35s ease-out;
}
@keyframes badgeBump {
    0%   { transform: scale(1); }
    30%  { transform: scale(1.08); }
    100% { transform: scale(1); }
}

/* XP바 펄스 효과 */
.xp-bar-fill.flash {
    animation: xpPulse 0.8s ease-out;
}
@keyframes xpPulse {
    0%   { box-shadow: 0 0 0 rgba(168,213,226,0); }
    40%  { box-shadow: 0 0 12px rgba(168,213,226,0.95); }
    100% { box-shadow: 0 0 0 rgba(168,213,226,0); }
}

/* ===== 설정 모달 ===== */
.settings-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.25);
    z-index: 150;
    display: flex;
    align-items: center;
    justify-content: center;
}
.settings-overlay.hidden { display: none; }

/* 옅은 나무 질감 패널 */
.settings-panel {
    position: relative;
    width: clamp(280px, 70vw, 380px); /* 최소, 최적, 최대 너비 설정 */
    max-height: 85vh; /* 높이는 화면 대비 비율 유지 */
    background: #f6ede3;
    background-image: linear-gradient(135deg, rgba(255,255,255,0.6), rgba(255,255,255,0) 40%),
                      linear-gradient(0deg, rgba(0,0,0,0.03), rgba(0,0,0,0.03)),
                      repeating-linear-gradient(90deg, rgba(163,121,94,0.08) 0 2px, rgba(163,121,94,0.06) 2px 4px);
    border: 3px solid #8f5a49; /* 짙은 나무색 테두리 */
    border-radius: 18px;
    box-shadow: 0 16px 28px rgba(0,0,0,0.25), inset 0 2px 0 rgba(255,255,255,0.6);
    padding: 16px 18px;
    animation: settingsPop 240ms cubic-bezier(0.2,0.9,0.2,1) forwards;
}

@keyframes settingsPop {
    from { opacity: 0; transform: translateY(12px) scale(0.96); }
    to   { opacity: 1; transform: translateY(6px)  scale(1); }
}

.settings-header {
    display: flex;
    align-items: center;
    justify-content: center; /* 제목을 중앙으로 정렬 */
    margin-bottom: 12px;
    padding-top: 8px; /* 닫기 버튼을 위한 공간 확보 */
}
.settings-title {
    margin: 0;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: bold;
    color: #5a3d2f;
    font-size: clamp(20px, 2rem, 26px);
}
.settings-close {
    position: absolute;
    top: -16px;
    right: -16px;
    width: 40px; /* 크기를 살짝 키워 둥근 느낌 강조 */
    height: 40px;
    background: #ff6b6b; /* 붉은색 배경 */
    border: 3px solid #fff;
    /* 손으로 그린 듯한 귀여운 원 모양 */
    border-radius: 45% 55% 42% 58% / 56% 49% 51% 44%;
    cursor: pointer;
    color: #fff;
    font-family: sans-serif; /* X 모양은 기본 폰트가 더 적합 */
    font-size: 24px;
    font-weight: bold;
    display: flex; /* Flexbox로 전환하여 정렬 미세 조정 */
    align-items: center;
    justify-content: center;
    padding: 0 0 3px 0; /* 아래쪽 패딩으로 X를 살짝 위로 올림 */
    box-sizing: border-box; /* 패딩이 크기에 포함되도록 설정 */
    box-shadow: 0 4px 10px rgba(0, 0, 0, 0.25);
    transition: all 0.2s ease; /* 모든 속성에 전환 효과 적용 */
    transform: rotate(-8deg); /* 살짝 기울여서 귀여운 느낌 추가 */
}
.settings-close:hover {
    transform: scale(1.1) rotate(5deg); /* 호버 시 반대로 회전하며 커짐 */
    background-color: #ff5252;
    /* 호버 시 모양도 살짝 변경 */
    border-radius: 55% 45% 52% 48% / 46% 59% 41% 54%;
}

.settings-body {
    display: flex;
    flex-direction: column;
    gap: 12px;
}
.settings-row {
    display: grid;
    /* 라벨(고정폭), 슬라이더(나머지), 값(auto)으로 설정해 슬라이더 길이 통일 */
    grid-template-columns: 80px 1fr auto;
    gap: 12px;
    align-items: center;
}
.settings-label {
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    color: #654321;
    white-space: nowrap;
}
.settings-value {
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    color: #654321;
    width: 48px;
    text-align: right;
}

/* 슬라이더 커스텀 */
.settings-row input[type="range"] {
    -webkit-appearance: none;
    appearance: none;
    height: 8px;
    background: #e3d5c9;
    border-radius: 999px;
    outline: none;
}
.settings-row input[type="range"]::-webkit-slider-thumb {
    -webkit-appearance: none;
    appearance: none;
    width: 24px; height: 24px; /* 크기 증가 */
    background: #d89950;
    border: 3px solid #ffffff;
    border-radius: 50%;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    cursor: pointer;
    margin-top: 0px; /* (thumb 높이 - track 높이) / -2 에서 미세조정 */
}
.settings-row input[type="range"]::-moz-range-thumb {
    width: 24px; height: 24px; /* 크기 증가 */
    background: #d89950;
    border: 3px solid #ffffff;
    border-radius: 50%;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
    cursor: pointer;
}

/* 일시정지 상태: 모든 하위 요소 애니메이션/트랜지션 중지 */
#main-container.paused *,
#main-container.paused *::before,
#main-container.paused *::after {
    animation-play-state: paused !important;
    transition: none !important;
}

/* 타자 커서 깜빡임도 중지 */
#main-container.paused .dialog-text.typing::after {
    animation-play-state: paused !important;
}

/* ===== 강화(업그레이드) 패널 ===== */
.upgrade-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.25);
    z-index: 150;
    display: flex;
    align-items: center;
    justify-content: center;
}
.upgrade-overlay.hidden { display: none; }

.upgrade-panel {
    position: relative;
    width: min(92vw, 560px);
    max-height: 78vh; /* 화면 높이의 85%를 최대로 설정하여 상하 여백 확보 */
    background: #f6ede3;
    background-image: linear-gradient(135deg, rgba(255,255,255,0.6), rgba(255,255,255,0) 40%),
                      linear-gradient(0deg, rgba(0,0,0,0.03), rgba(0,0,0,0.03)),
                      repeating-linear-gradient(90deg, rgba(163,121,94,0.08) 0 2px, rgba(163,121,94,0.06) 2px 4px);
    border: 3px solid #8f5a49;
    border-radius: 18px;
    box-shadow: 0 16px 28px rgba(0,0,0,0.25), inset 0 2px 0 rgba(255,255,255,0.6);
    display: flex;
    flex-direction: column;
    animation: settingsPop 240ms cubic-bezier(0.2,0.9,0.2,1) forwards;
}

.upgrade-header {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 12px 14px;
    padding-top: 18px;
    border-bottom: 2px solid #dccfbf;
    flex-shrink: 0;
}
.upgrade-title {
    margin: 0;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: bold;
    color: #5a3d2f;
    font-size: clamp(20px, 2rem, 26px);
}
.upgrade-close {
    position: absolute;
    top: -16px;
    right: -16px;
    width: 40px; height: 40px;
    background: #ff6b6b; border: 3px solid #fff;
    border-radius: 45% 55% 42% 58% / 56% 49% 51% 44%;
    color: #fff; font-family: sans-serif; font-size: 24px; font-weight: bold;
    display: flex; align-items: center; justify-content: center;
    padding: 0 0 3px 0; box-sizing: border-box; cursor: pointer;
    box-shadow: 0 4px 10px rgba(0,0,0,0.25);
    transform: rotate(-8deg);
    transition: all 0.2s ease;
}
.upgrade-close:hover { transform: scale(1.1) rotate(5deg); background-color: #ff5252; }

/* 강화 패널 내 플레이어 상태 바 */
.player-status-bar {
    display: flex;
    justify-content: center;
    gap: 10px;
    padding: 10px 14px;
    background: rgba(0,0,0,0.05);
    border-bottom: 2px solid #dccfbf;
    flex-shrink: 0;
}
.status-badge-small {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 4px 10px;
    border-radius: 999px;
    background: #fff;
    border: 1px solid #dccfbf;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
}
.status-badge-small .badge-text {
    font-size: clamp(15px, 1.6rem, 18px); /* 폰트 크기 증가 */
    color: #5a3d2f;
}
.badge-icon-small {
    width: 1.4em; /* 아이콘 크기 증가 */
    height: 1.4em; /* 아이콘 크기 증가 */
}

.upgrade-body {
    padding: 12px;
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 14px;
}

/* 강화 UI 커스텀 스크롤바 */
.upgrade-body::-webkit-scrollbar {
    width: 10px;
}
.upgrade-body::-webkit-scrollbar-track {
    background: #e3d5c9; /* 스크롤바 배경 (트랙) */
    border-radius: 10px;
    margin: 10px 0;
}
.upgrade-body::-webkit-scrollbar-thumb {
    background: #8f5a49; /* 스크롤바 핸들 (막대) */
    border-radius: 10px;
    border: 2px solid #f6ede3; /* 핸들 주변 여백 효과 */
}
.upgrade-body::-webkit-scrollbar-thumb:hover {
    background: #7a4a39; /* 호버 시 색상 */
}

/* 스킬 그룹 */
.skill-group {
    background: rgba(0,0,0,0.03);
    border: 1px solid rgba(0,0,0,0.08);
    border-radius: 12px;
    padding: 12px;
}
.group-title {
    margin: 0 0 4px 2px;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: bold;
    color: #8f5a49;
    font-size: clamp(16px, 1.8rem, 20px);
}
.group-desc {
    margin: 0 0 10px 2px;
    font-family: 'GeumEunBoHwa', cursive;
    font-size: clamp(13px, 1.3rem, 15px);
    color: #6b584f;
}

/* 스킬 카드들을 담는 컨테이너 */
.skill-group > .skill-card {
    margin-top: 10px; /* 스킬 카드 간의 여백 */
}

/* 스킬 카드 */
.skill-card {
    display: flex;
    gap: 12px;
    align-items: stretch;
    background: #fff;
    border: 2px solid #8f5a49;
    border-radius: 12px;
    box-shadow: 0 2px 6px rgba(0,0,0,0.08);
    padding: 12px;
}
.skill-media {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 8px;
    flex-shrink: 0;
    width: 72px; /* 아이콘 너비를 고정하여 줄바꿈 기준점으로 설정 */
}
.skill-icon-ph {
    width: 68px;
    height: 68px;
    border-radius: 12px;
    background: linear-gradient(135deg, #e0d8c7 0%, #d8cfc3 100%);
    color: #5a3d2f;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 36px;
    font-weight: 700;
    box-shadow: inset 0 2px 4px rgba(0,0,0,0.1);
}

/* 레벨 점 표시 */
.level-dots {
    display: flex;
    gap: 4px; /* 점 간격 축소 */
    flex-wrap: wrap; /* 점이 많아지면 줄바꿈 허용 */
    justify-content: center; /* 중앙 정렬 */
    padding: 0; /* 불필요한 패딩 제거 */
}
.level-dots .dot {
    width: 8px; /* 점 크기 축소 */
    height: 8px; /* 점 크기 축소 */
    border-radius: 50%;
    background: #d8cfc3;
    border: 1px solid #cdbfae;
    transition: all 0.2s ease;
}
.level-dots .dot.filled {
    background: #f5c542;
    border-color: #e0a800;
    box-shadow: 0 0 8px rgba(245,197,66,0.9);
    transform: scale(1.1);
}

.skill-content {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    gap: 8px;
}
.skill-title-row {
    display: flex;
    align-items: flex-start; /* 상단 정렬 */
    justify-content: space-between;
    gap: 10px;
}
.skill-name-wrapper {
    display: flex;
    flex-direction: column; /* 이름과 레벨을 수직으로 배치 */
}
.skill-name {
    margin: 0;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: bold;
    color: #5a3d2f;
    font-size: clamp(16px, 1.7rem, 19px);
    line-height: 1.2; /* 줄간격 조정 */
}
.skill-level {
    font-family: 'GeumEunBoHwa', cursive;
    font-size: clamp(12px, 1.3rem, 14px);
    color: #8f5a49;
    font-weight: 600;
}
.upgrade-btn {
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: bold;
    font-size: clamp(13px, 1.4rem, 16px);
    padding: 8px 12px;
    border-radius: 10px;
    border: 2px solid #8f5a49;
    background: #ff9a4f; /* 따뜻한 주황색으로 변경 */
    color: #fff;
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
    transition: all 0.2s ease;
    flex-shrink: 0;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.2); /* 가독성을 위한 그림자 */
}
.upgrade-btn:hover {
    background: #ff8a38; /* 호버 시 살짝 더 진하게 */
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(255, 154, 79, 0.4); /* 주황색 그림자 */
}
.upgrade-btn:active {
    transform: translateY(0);
}
.upgrade-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
    opacity: 0.6;
}
.cost-icon {
    width: 1.1em;
    height: 1.1em;
}
.skill-desc {
    margin: 0;
    font-family: 'GeumEunBoHwa', cursive;
    font-size: clamp(13px, 1.3rem, 15px);
    color: #6b584f;
    line-height: 1.4;
}

/* 현재/다음 효과 표시 */
.skill-effects {
    margin-top: 4px;
}
.effect-row {
    margin: 0;
    font-family: 'GeumEunBoHwa', cursive;
    font-size: clamp(13px, 1.3rem, 15px);
    display: flex;
    gap: 6px;
}
.effect-label {
    font-weight: 600;
    color: #8f5a49;
    flex-shrink: 0;
    width: 3.5em; /* '현재:', '다음:' 라벨 너비 고정 */
}
.effect-desc {
    color: #5a3d2f;
}
.effect-row.next .effect-desc {
    font-weight: bold;
    color: #ff8a38; /* 다음 효과 텍스트도 주황색 계열로 변경 */
}

/* 비활성화된(잠긴) 스킬 카드 스타일 */
.skill-card.locked {
    opacity: 0.6;
    background: #f0ede8;
}
.skill-card.locked .upgrade-btn {
    background: #aaa;
    border-color: #888;
    color: #555;
    cursor: not-allowed;
}
.skill-card.locked .upgrade-btn:hover {
    background: #aaa;
    transform: none;
    box-shadow: none;
}

/* ===== 상점 패널 ===== */
.shop-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.25);
    z-index: 150;
    display: flex;
    align-items: center;
    justify-content: center;
}
.shop-overlay.hidden { display: none; }

.shop-panel {
    position: relative;
    width: min(92vw, 560px);
    max-height: 83vh;
    background: #f6ede3;
    background-image: linear-gradient(135deg, rgba(255,255,255,0.6), rgba(255,255,255,0) 40%),
                      linear-gradient(0deg, rgba(0,0,0,0.03), rgba(0,0,0,0.03)),
                      repeating-linear-gradient(90deg, rgba(163,121,94,0.08) 0 2px, rgba(163,121,94,0.06) 2px 4px);
    border: 3px solid #8f5a49;
    border-radius: 18px;
    box-shadow: 0 16px 28px rgba(0,0,0,0.25), inset 0 2px 0 rgba(255,255,255,0.6);
    display: flex;
    flex-direction: column;
    animation: settingsPop 240ms cubic-bezier(0.2,0.9,0.2,1) forwards;
}

.shop-header {
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 12px 14px;
    padding-top: 18px;
    border-bottom: 2px solid #dccfbf;
    flex-shrink: 0;
}
.shop-title {
    margin: 0;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: bold;
    color: #5a3d2f;
    font-size: clamp(20px, 2rem, 26px);
}
.shop-close {
    position: absolute;
    top: -16px;
    right: -16px;
    width: 40px; height: 40px;
    background: #ff6b6b; border: 3px solid #fff;
    border-radius: 45% 55% 42% 58% / 56% 49% 51% 44%;
    color: #fff; font-family: sans-serif; font-size: 24px; font-weight: bold;
    display: flex; align-items: center; justify-content: center;
    padding: 0 0 3px 0; box-sizing: border-box; cursor: pointer;
    box-shadow: 0 4px 10px rgba(0,0,0,0.25);
    transform: rotate(-8deg);
    transition: all 0.2s ease;
}
.shop-close:hover { transform: scale(1.1) rotate(5deg); background-color: #ff5252; }

/* 탭 */
.shop-tabs {
    display: flex; gap: 8px; justify-content: center; padding: 10px 12px; border-bottom: 2px solid #dccfbf;
}
.shop-tab {
    padding: 6px 12px; border-radius: 999px; border: 2px solid #8f5a49; background: #fff; color: #5a3d2f;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive; font-weight: 700; cursor: pointer; transition: all 0.2s ease;
}
.shop-tab.active { background: #ffecd4; border-color: #ae6a3a; }

/* 바디 */
.shop-body { padding: 12px; overflow-y: auto; display: flex; flex-direction: column; gap: 12px; }
.shop-tab-content { display: grid; grid-template-columns: 1fr; gap: 10px; }

/* 카드 */
.shop-item-card {
    display: grid; grid-template-columns: auto 1fr auto; align-items: center; gap: 10px;
    background: #fff; border: 2px solid #8f5a49; border-radius: 12px; padding: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.08);
}
.shop-item-card.locked { opacity: 0.6; background: #f0ede8; }
.shop-item-card.purchased { opacity: 0.7; }

.shop-item-icon { width: 56px; height: 56px; border-radius: 10px; background: #e0d8c7; display: flex; align-items: center; justify-content: center; font-size: 26px; }
.shop-item-icon.paint-preview { font-size: 0; border: 2px solid #8f5a49; }

.shop-item-info { display: flex; flex-direction: column; gap: 4px; }
.shop-item-name { margin: 0; font-family: 'Amsterdam', 'GeumEunBoHwa', cursive; font-weight: bold; color: #5a3d2f; font-size: 1.15rem; }
.shop-item-desc { margin: 0; font-family: 'GeumEunBoHwa', cursive; font-size: 0.7rem; color: #807c7a; font-weight: 700; }
.shop-item-requirement { margin: 0; font-family: 'GeumEunBoHwa', cursive; font-size: 0.9rem; color: #8f5a49; font-weight: 700; }

/* 버튼 */
.shop-buy-btn {
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive; font-weight: bold; font-size: 1.0rem; padding: 6px 10px; border-radius: 8px; border: 2px solid #8f5a49; background: #ff9a4f; color: #fff; display: flex; align-items: center; gap: 5px; cursor: pointer; transition: all 0.2s ease; flex-shrink: 0;
}
.shop-buy-btn:hover { background: #ff8a38; transform: translateY(-2px); box-shadow: 0 4px 8px rgba(255, 154, 79, 0.4); }
.shop-buy-btn:disabled, .shop-buy-btn.disabled { background: #aaa; border-color: #888; color: #555; cursor: not-allowed; transform: none; box-shadow: none; }
.shop-buy-btn.purchased-label { background: #a8d5e2; border-color: #5d6b7a; color: #2c2320; cursor: default; }
.cost-icon { width: 1.1em; height: 1.1em; }

/* 강화 탭 */
.upgrade-tabs {
    display: flex;
    gap: 8px;
    justify-content: center;
    padding: 10px 12px;
    border-bottom: 2px solid #dccfbf;
    flex-shrink: 0;
}
.upgrade-tab {
    padding: 6px 12px;
    border-radius: 999px;
    border: 2px solid #8f5a49;
    background: #fff;
    color: #5a3d2f;
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
}
.upgrade-tab.active {
    background: #ffecd4;
    border-color: #ae6a3a;
}
.upgrade-tab-content {
    display: flex;
    flex-direction: column;
    gap: 10px;
}
.upgrade-tab-content.hidden {
    display: none;
}

/* ===== 알림 메시지 (토스트) ===== */
#notification-container {
    position: absolute;
    top: 25px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 9999;
    display: flex;
    flex-direction: column;
    align-items: center;
    /* gap: 10px; */ /* gap 대신 margin으로 간격 제어 */
    pointer-events: none;
}

.notification-toast {
    background: #f6ede3;
    background-image: linear-gradient(135deg, rgba(255,255,255,0.6), rgba(255,255,255,0) 40%),
                      repeating-linear-gradient(90deg, rgba(163,121,94,0.08) 0 2px, rgba(163,121,94,0.06) 2px 4px);
    color: #5a3d2f;
    padding: 10px 22px;
    border-radius: 999px;
    border: 2px solid #8f5a49;
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.15);
    font-family: 'Amsterdam', 'GeumEunBoHwa', cursive;
    font-size: 1.2rem;
    font-weight: bold;
    animation: fadeInOut 3s cubic-bezier(0.2, 0.9, 0.2, 1.2) forwards;
    white-space: nowrap;
    margin-bottom: 10px; /* 아이템 간 간격 */
    transition: all 0.4s cubic-bezier(0.6, 0, 0.4, 1); /* 사라질 때 애니메이션 */
}

.notification-toast.removing {
    opacity: 0;
    transform: scale(0.8);
    height: 0;
    padding-top: 0;
    padding-bottom: 0;
    margin-bottom: 0;
    border-width: 0;
}

@keyframes fadeInOut {
    0% { opacity: 0; transform: translateY(-25px) scale(0.9); }
    15% { opacity: 1; transform: translateY(0) scale(1); }
    85% { opacity: 1; transform: translateY(0) scale(1); }
    100% { opacity: 0; transform: translateY(-25px) scale(0.9); }
}
